language: node_js
services:
- docker
env:
  global:
  - DOCKER_IMAGE_NAME=marcelmichau/horizon-with-docker
  - COMMIT=${TRAVIS_COMMIT::8}
  - secure: QIINP4l1Qol9M7CqN+dT2SgaUmBkWXQ0OA82+ohJJQYYJGbHAOWTLML7nB/RQC8tmX0yFqPGwYOjN/mPxaGkTURcvPJVswtMUpacGKCDaV3I+Ny6TS1MCU/j/lU3X2B0hQi0s8fbKMpRRfrRVWdqO7kKpzPtqOiXfr1Lyzs07PI/QkMl1q8bGUgdtiWK/itS3X05Vtc2Vq12tDYKAxdVvlz11B1rr3k7eB8zJcUBDNYqns8Cgge71gItfj/vglEYjPRjAfkggltnedEDjjpms3gCx+7jL+WlBnn7Ksf28FNMLYYN9nZleIGjwT71ECtRPPltridwRS/joA/LALuzL+HFYC0e6lxGnFkhHv9UvXDBW0gCl+Rs7TS8fN37TMAReqId7kJVr6oT3QLf+8wqKq2yi4VYN37dPu/CDgtEONiZ+t8ZmT557voYX946USYDMe1UxrvNA8F88BOHvSjn+3XPfc25mMDiTs2gIiVkLEkXZKLUzMIOf78U3okDFIOEuk4vHM5sgeTooLz6ztP5PzJJOOw0BeKAj4xlJyiXqApjdUqbZLKWp7bGxtQ+xwu6Xwpz6MOWViF5mrpJcNnm35a0fvo1ikiHpeywNMx5y9oosQQ1Vrg1yvR7yUhBtCGA7zg8E9kFKX14es1FrrPNAGCU6KfhCI5Z45lNipq999U=
  - secure: vxjbBKlwP+S53kFbFfnWpz/wEQnW5h8UAsJtSgrswvAezaONlKTHabDZQocyF1H2gRE3LM71Jfas/c/dOt7xx/HN4h6nNU4Opfguas4iuH9Ma/Y1oO83r4bPk772gMXJ+hL0f85N2BHBJcilpbNWoVZyl8TcADiciCENK4yeoEHGQXP1DNfQtY49XvRcnpbobHrBnP0EBjRylsB3LGuh54rYSMrukZ7TbfWlh5nVUO07FFil6fRWlKLFO1y8rTiPv3X5VWQ29WcM3BINf8KgI4uCbSERkroQXTmXmZRMXTry4R5InJKIJgIKhpC0BJikvzwsxapy27IxE0ZJDI+vqqjJRYE5//hYvOKkav2YzM9IMs4oqvVmqly+OCa9Ql5BN01A+zIxaIy6/OT4j3tiddL2yxdcIsz3ULoQmD7+UeAvCwSx+w9igv524S1ctu6YNbqgzy/r+bJl98BxQRemJW8O9GPbXJehLATwh+vEWgnEJFhNQYY2ONk+NHBX64aoUY5QLwIe5RkmOoNqeEH0hPLkt8YpQ/W49mKiGYM9iEuk6ADB2+CttdAx0YzZdi2iQhWHHnK9ktRVYw+KAZaW4cAWNRW2NbPDYuUPcQqMKjhJAyydqC/K+ULegtoqV/bG/V3LHoIiXc4CHTe+VCAxJ54IrsfBlpIW17Cmk4QTNJI=
  - secure: uD5GXsDMX9vK2NcONu3Hcpu2bK9wB6Ut0jjkKEnEaXtnwm93eJCquii6CM08xLt6FA95JgX++nwrcP/dO+ewy/EhZT/AIHtU4/kWYUg5Y/LzHnt8wSbTOlo032pI3gkewRq+wTVY5zQ8DyMOjCXC7LYB9wSieWW45JtofYCig+UMY6/UahmYJbpuHyR45mpQG1brTqjXtAXEl3/wI21xEn0ig25m4FvJHHjF9zZJKt3eKyw+wlxsMWWH6i/j4J73sl3jImJjgjV0g4mLuS9lDpn2CysUpXpEw5C4zP8tB4NNlW3Cu9meXwQ/Bw+okDcmk1dy0vHaZ1XYU8EJyq8lLOB0wB2gXNjp7FNV9SQqToNQb6tfuUA2Ym6MBiOQ+ND3rNZnLInLOIhJxoZzM7IoENVbxZCzaXWeowKONSprb/kWkkrTyfTDH+ys9OENse97yilvlVhPlqAKPYVzv22nhCvy07UDVBlyWkITnXdE+PCtL9V0x4Llwxm4+NPj0dLV6wQEooBYB62n0VBSw6Z1R7UOu9VCR4AKS32O1p2axWBmmXYnUJgSIOjko6RTqetwkImseGl1UHF0TxSQsH2uioVEAy9slPi0Ifth+gk/lusgrtlF5snJPTpnwMLa45G4J3PxBV4uyRyVqf7D1h8b/hatCIO1SxnKW0dnQh/XPnE=
after_success:
 - docker login -e="$DOCKER_EMAIL" -u="$DOCKER_USER" -p="$DOCKER_PASS"
 - docker build -f Dockerfile -t $DOCKER_IMAGE_NAME .
 - if [ ! -z "$TRAVIS_TAG" ]; then
      docker tag $DOCKER_IMAGE_NAME:latest $DOCKER_IMAGE_NAME:$TRAVIS_TAG;
    fi
 - if [ "$TRAVIS_BRANCH" == "master" ]; then
      docker push $DOCKER_IMAGE_NAME;
    fi